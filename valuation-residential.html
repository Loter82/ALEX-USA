<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üö® Get Emergency Cash Offer | Stop Foreclosure NOW</title>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17936379407"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'AW-17936379407');
    </script>
    
    <!-- Event snippet for Request quote conversion page
    In your html page, add the snippet and call gtag_report_conversion when someone clicks on the chosen link or button. -->
    <script>
    function gtag_report_conversion(url) {
      var callback = function () {
        if (typeof(url) != 'undefined') {
          window.location = url;
        }
      };
      gtag('event', 'conversion', {
          'send_to': 'AW-17936379407/lep7CMT_hvkbEI_c3ehC',
          'value': 1.0,
          'currency': 'USD',
          'event_callback': callback
      });
      return false;
    }
    </script>
    <link rel="stylesheet" href="styles.css?v=2">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0f1419 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes urgentGlow {
            0%, 100% { 
                box-shadow: 0 0 30px rgba(239, 68, 68, 0.5), 0 0 60px rgba(239, 68, 68, 0.3); 
            }
            50% { 
                box-shadow: 0 0 50px rgba(239, 68, 68, 0.8), 0 0 100px rgba(239, 68, 68, 0.5); 
            }
        }

        /* Emergency Banner */
        .emergency-banner {
            background: linear-gradient(90deg, #dc2626 0%, #ef4444 50%, #dc2626 100%);
            padding: 18px 20px;
            text-align: center;
            font-weight: 800;
            font-size: 1.15em;
            letter-spacing: 1.5px;
            animation: urgentGlow 2s infinite;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.5);
        }

        .emergency-banner span {
            display: inline-block;
            animation: pulse 2s infinite;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.1);
            height: 8px;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            height: 100%;
            transition: width 0.5s ease;
        }

        .step-indicator {
            text-align: center;
            color: #9ca3af;
            margin-bottom: 20px;
            font-size: 1em;
            font-weight: 600;
        }

        h1 {
            font-size: 2.8em;
            text-align: center;
            margin-bottom: 15px;
            color: #ffffff;
            text-shadow: 2px 2px 15px rgba(0, 0, 0, 0.7);
        }

        h1 .urgent-text {
            color: #ef4444;
            font-weight: 900;
        }

        .subtitle {
            text-align: center;
            color: #d1d5db;
            font-size: 1.2em;
            margin-bottom: 40px;
            line-height: 1.6;
        }

        /* Section Card */
        .section-card {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border: 2px solid #334155;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #ffffff;
            font-weight: 600;
            font-size: 1.05em;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #334155;
            border-radius: 10px;
            color: #ffffff;
            font-size: 1em;
            transition: all 0.3s;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        .form-group select option {
            background: #0f172a;
            color: #ffffff;
        }

        .form-group small {
            color: #9ca3af;
            font-size: 0.9em;
            display: block;
            margin-top: 8px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        /* Button */
        .button-primary {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.3em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .button-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.5);
        }

        .button-primary:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        /* Spinner */
        .spinner-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 14, 39, 0.9);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .spinner-overlay.active {
            display: flex;
        }

        .spinner-content {
            text-align: center;
        }

        .spinner {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(16, 185, 129, 0.2);
            border-top: 8px solid #10b981;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 25px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .spinner-text {
            color: #ffffff;
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .spinner-subtext {
            color: #9ca3af;
            font-size: 1em;
        }

        /* Dropdown Menu */
        .dropdown-menu {
            position: absolute;
            background: #1e293b;
            border: 2px solid #334155;
            border-radius: 10px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            width: calc(100% - 40px);
            margin-top: 5px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .dropdown-item {
            padding: 15px;
            cursor: pointer;
            color: #d1d5db;
            transition: all 0.2s;
        }

        .dropdown-item:hover {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        /* Value Display */
        .value-range {
            text-align: center;
            padding: 50px 30px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-radius: 20px;
            margin-bottom: 30px;
            border: 4px solid #fbbf24;
            animation: urgentGlow 3s infinite;
        }

        .value-range-title {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .value-range-amount {
            color: #ffffff;
            font-size: 3.5em;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 3px 3px 15px rgba(0, 0, 0, 0.5);
        }

        .value-range-subtitle {
            color: rgba(255, 255, 255, 0.85);
            font-size: 1em;
        }

        #basicInfo {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-box {
            text-align: center;
            padding: 25px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #334155;
            border-radius: 15px;
            transition: all 0.3s;
        }

        .info-box:hover {
            border-color: #10b981;
            transform: translateY(-5px);
        }

        .info-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .info-label {
            color: #9ca3af;
            font-size: 0.85em;
            margin-bottom: 8px;
        }

        .info-value {
            color: #ffffff;
            font-size: 1.3em;
            font-weight: 700;
        }

        /* CTA Box */
        .cta-box {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border: 3px solid #10b981;
            padding: 40px;
            border-radius: 20px;
            margin-top: 30px;
        }

        .cta-box h3 {
            color: #10b981;
            margin-bottom: 20px;
            font-size: 1.8em;
            text-align: center;
        }

        .cta-box ul {
            list-style: none;
            margin: 25px 0;
        }

        .cta-box li {
            padding: 15px 0;
            padding-left: 35px;
            position: relative;
            color: #d1d5db;
            font-size: 1.05em;
            line-height: 1.6;
        }

        .cta-box li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #10b981;
            font-weight: bold;
            font-size: 1.5em;
        }

        /* Lead Form */
        .lead-form {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);
            border: 4px solid #fbbf24;
            border-radius: 25px;
            padding: 50px 40px;
            margin-top: 30px;
            box-shadow: 0 30px 80px rgba(239, 68, 68, 0.5);
            animation: urgentGlow 3s infinite;
        }

        .lead-form h2 {
            color: #ffffff;
            margin-bottom: 15px;
            font-size: 2.3em;
            text-align: center;
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.5);
        }

        .lead-form .subtitle {
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 35px;
            font-size: 1.1em;
        }

        .lead-form .form-group input {
            background: rgba(255, 255, 255, 0.95);
            color: #1a1a1a;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .lead-form .form-group input:focus {
            border-color: #fbbf24;
            background: #ffffff;
        }

        .lead-form .form-group label {
            color: #ffffff;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }

        .lead-form .form-group small {
            color: rgba(255, 255, 255, 0.8);
        }

        .submit-btn {
            width: 100%;
            padding: 22px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #1a1a1a;
            border: 3px solid #ffffff;
            border-radius: 15px;
            font-size: 1.4em;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            animation: pulse 2s infinite;
        }

        .submit-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6);
        }

        .bonus-badge {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 25px 0;
            text-align: center;
        }

        .bonus-badge .icon {
            font-size: 1.5em;
            margin-bottom: 10px;
            font-weight: bold;
            color: #ffffff;
        }

        .bonus-badge .text {
            color: #ffffff;
            font-weight: 700;
            font-size: 1.1em;
            line-height: 1.5;
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid #ef4444;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            color: #ef4444;
            text-align: center;
        }

        /* Back Link */
        .back-link {
            text-align: center;
            margin-top: 40px;
        }

        .back-link a {
            color: #10b981;
            text-decoration: none;
            font-size: 1.05em;
            font-weight: 600;
            transition: all 0.3s;
        }

        .back-link a:hover {
            color: #059669;
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .value-range-amount {
                font-size: 2.5em;
            }

            .section-card {
                padding: 25px 20px;
            }

            .lead-form {
                padding: 35px 25px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Emergency Banner -->
    <div class="emergency-banner">
        <span>üö® FORECLOSURE EMERGENCY? GET CASH OFFER IN 24 HOURS</span>
    </div>

    <!-- Spinner Overlay -->
    <div class="spinner-overlay" id="spinnerOverlay">
        <div class="spinner-content">
            <div class="spinner"></div>
            <div class="spinner-text">Analyzing Your Property...</div>
            <div class="spinner-subtext">Getting real-time market data from ATTOM</div>
        </div>
    </div>

    <div class="container">
        <div class="step-indicator">Step <span id="currentStep">1</span> of 2</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 50%;"></div>
        </div>
        
        <h1><span class="urgent-text">STOP FORECLOSURE</span><br>Get Your Emergency Cash Offer</h1>
        <p class="subtitle">Enter your property address to see your estimated value and get a no-obligation cash offer in 24 hours</p>
        
        <!-- Step 1: Property Address Form -->
        <div id="searchSection" class="section-card">
            <div id="error" class="error-message" style="display: none;"></div>
            <form id="propertyForm">
                <div class="form-group">
                    <label>State *</label>
                    <select id="state" required>
                        <option value="">Select Your State</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>City *</label>
                    <input type="text" id="city" placeholder="Enter your city" autocomplete="off" required>
                    <div id="cityDropdown" class="dropdown-menu" style="display: none;"></div>
                </div>
                
                <div class="form-group">
                    <label>Street Address *</label>
                    <input type="text" id="address" placeholder="Enter your street address" autocomplete="off" required>
                    <div id="addressDropdown" class="dropdown-menu" style="display: none;"></div>
                    <small>Select from dropdown to auto-fill ZIP code</small>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>ZIP Code *</label>
                        <input type="text" id="zipcode" placeholder="Auto-filled" readonly style="background: rgba(255, 255, 255, 0.02); cursor: not-allowed; opacity: 0.7;" required>
                        <small>Will be filled automatically</small>
                    </div>
                    
                    <div class="form-group">
                        <label>Square Feet (optional)</label>
                        <input type="number" id="squareFeet" placeholder="2000">
                    </div>
                </div>
                
                <button type="submit" class="button-primary">
                    üíµ Get My Cash Offer Now ‚Üí
                </button>
            </form>
        </div>
        
        <!-- Step 1.5: Preliminary Results -->
        <div id="preliminaryResults" style="display: none;">
            <div class="value-range">
                <div class="value-range-title">üè† ESTIMATED PROPERTY VALUE</div>
                <div class="value-range-amount" id="valueRange">$145,000 - $165,000</div>
                <div class="value-range-subtitle">Based on ATTOM data and comparable sales</div>
            </div>
            
            <div id="basicInfo">
                <!-- Property info will be inserted here -->
            </div>
            
            <div class="cta-box">
                <h3>‚úÖ Why Accept Our Cash Offer?</h3>
                <ul>
                    <li><strong>Cash Offer in 24 Hours</strong> - Stop foreclosure immediately</li>
                    <li><strong>No Repairs Needed</strong> - We buy houses as-is, any condition</li>
                    <li><strong>Zero Fees & Commissions</strong> - Save thousands in realtor fees</li>
                    <li><strong>Close in 7-14 Days</strong> - Get cash fast when you need it most</li>
                    <li><strong>We Handle Everything</strong> - Paperwork, liens, legal issues</li>
                    <li><strong>100% Confidential</strong> - Your privacy is protected</li>
                </ul>
                <button onclick="showLeadForm()" class="button-primary" style="margin-top: 25px;">
                    Get My Official Cash Offer Now
                </button>
            </div>
        </div>
        
        <!-- Step 2: Lead Form -->
        <div id="leadFormSection" class="lead-form" style="display: none;">
            <h2>üö® Get Your Cash Offer</h2>
            <p class="subtitle">Fill out your contact information below. We'll send you an official cash offer within 24 hours. No obligation to accept.</p>
            
            <form id="leadForm">
                <div class="form-group">
                    <label>Your Full Name *</label>
                    <input type="text" id="leadName" placeholder="John Smith" required>
                </div>
                
                <div class="form-group">
                    <label>Email Address *</label>
                    <input type="email" id="leadEmail" placeholder="john@example.com" required>
                    <small>We'll send your official cash offer to this email</small>
                </div>
                
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" id="leadPhone" placeholder="(555) 123-4567" required>
                    <small>Best number to reach you for urgent matters</small>
                </div>
                
                <div class="bonus-badge">
                    <div class="icon">‚ö° EMERGENCY RESPONSE</div>
                    <div class="text">Cash Offer in 24 Hours ‚Ä¢ No Fees ‚Ä¢ No Repairs ‚Ä¢ Close in 7 Days</div>
                </div>
                
                <button type="submit" class="submit-btn">
                    üíµ GET MY CASH OFFER NOW
                </button>
                
                <p style="text-align: center; color: rgba(255, 255, 255, 0.8); font-size: 0.9em; margin-top: 20px;">
                    üîí Your information is secure. No obligation - you can decline our offer at any time.
                </p>
            </form>
        </div>
        
        <!-- Step 3: Full Results -->
        <div id="fullResults" style="display: none;">
            <div id="results">
                <div id="valuationInfo"></div>
                <div id="propertyInfo"></div>
                <div id="salesInfo"></div>
                <div id="assessmentInfo"></div>
                <div id="schoolsInfo"></div>
            </div>
        </div>
        
        <div class="back-link">
            <a href="index.html">‚Üê Back to Home</a>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="config.js"></script>
    <script>
        (function() {
            if (typeof CONFIG !== 'undefined' && CONFIG.GOOGLE_PLACES_API_KEY) {
                const script = document.createElement('script');
                script.src = `https://maps.googleapis.com/maps/api/js?key=${CONFIG.GOOGLE_PLACES_API_KEY}&libraries=places&callback=initGooglePlaces`;
                script.async = true;
                script.defer = true;
                document.head.appendChild(script);
            } else {
                console.error('‚ùå Google API key not loaded from config.js');
            }
        })();
    </script>
    <script src="script.js"></script>
    <script>
        const stateSelectElement = document.getElementById('state');
        const cityInputElement = document.getElementById('city');
        
        if (stateSelectElement && cityInputElement) {
            stateSelectElement.addEventListener('change', function() {
                if (this.value) {
                    cityInputElement.placeholder = 'Type city in ' + this.options[this.selectedIndex].text;
                } else {
                    cityInputElement.placeholder = 'Enter your city';
                }
            });
        }
        
        const propertyForm = document.getElementById('propertyForm');
        if (propertyForm) {
            propertyForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                e.stopPropagation();
                
                const address = document.getElementById('address').value.trim();
                const city = document.getElementById('city').value.trim();
                const state = document.getElementById('state').value;
                const zipcode = document.getElementById('zipcode').value.trim();
                
                if (!state) {
                    alert('Please select a state first');
                    return;
                }
                if (!city) {
                    alert('Please enter a city');
                    return;
                }
                if (!address || !zipcode) {
                    alert('Please complete all fields');
                    return;
                }
            
                const formData = {
                    address,
                    city,
                    state,
                    zipcode,
                    squareFeet: document.getElementById('squareFeet').value
                };
                
                // Show spinner
                const spinner = document.getElementById('spinnerOverlay');
                const submitBtn = e.target.querySelector('.button-primary');
                const originalBtnText = submitBtn.textContent;
                
                spinner.classList.add('active');
                submitBtn.disabled = true;
                submitBtn.textContent = 'Analyzing Property...';
                
                try {
                    const data = await window.getPropertyData(formData);
                    propertyData = data;
                    
                    // Hide spinner
                    spinner.classList.remove('active');
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalBtnText;
                    
                    showPreliminaryResults(data);
                } catch (error) {
                    console.error('API error:', error);
                    
                    // Hide spinner
                    spinner.classList.remove('active');
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalBtnText;
                    
                    document.getElementById('error').textContent = error.message;
                    document.getElementById('error').style.display = 'block';
                    
                    // Scroll to error
                    document.getElementById('error').scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, true);
        }
        
        let propertyData = null;
        let leadSubmitted = false;
        
        async function showPreliminaryResults(data) {
            document.getElementById('searchSection').style.display = 'none';
            document.getElementById('preliminaryResults').style.display = 'block';
            document.getElementById('progressFill').style.width = '75%';
            
            if (data.needsSquareFeet && data.nearbyData) {
                const avgPricePerSqft = data.nearbyData.avgPricePerSqft;
                const lowEstimate = Math.round(avgPricePerSqft * 1000 * 0.7);
                const highEstimate = Math.round(avgPricePerSqft * 2000 * 0.7);
                
                const low = lowEstimate.toLocaleString('en-US');
                const high = highEstimate.toLocaleString('en-US');
                document.getElementById('valueRange').textContent = `$${low} - $${high}`;
                
                const basicInfoHTML = `
                    <div class="info-box" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); border-color: #10b981;">
                        <div class="info-icon" style="color: #fff;">$/SqFt</div>
                        <div class="info-label" style="color: rgba(255,255,255,0.9);">Avg Price per Sq Ft</div>
                        <div class="info-value" style="color: #fff;">$${avgPricePerSqft.toFixed(2)}</div>
                    </div>
                    <div class="info-box">
                        <div class="info-icon">üèòÔ∏è</div>
                        <div class="info-label">Properties Analyzed</div>
                        <div class="info-value">${data.nearbyData.propertiesUsed}</div>
                    </div>
                    <div class="info-box">
                        <div class="info-icon">üìç</div>
                        <div class="info-label">Search Radius</div>
                        <div class="info-value">${data.nearbyData.radius} mi</div>
                    </div>
                `;
                document.getElementById('basicInfo').innerHTML = basicInfoHTML;
                
                window.scrollTo({ top: document.getElementById('preliminaryResults').offsetTop - 100, behavior: 'smooth' });
                return;
            }
            
            const property = data.property;
            const avm = data.avm?.property?.[0]?.avm?.amount;
            
            let avgValue = null;
            let pricePerSqft = null;
            let squareFeet = null;
            
            if (avm) {
                avgValue = Math.round(((avm.low + avm.high) / 2) * 0.7);
                const low = Math.round(avm.low * 0.7).toLocaleString('en-US');
                const high = Math.round(avm.high * 0.7).toLocaleString('en-US');
                document.getElementById('valueRange').textContent = `$${low} - $${high}`;
                
                squareFeet = property?.building?.size?.bldgsize 
                    || property?.building?.size?.universalsize 
                    || property?.building?.size?.livingsize
                    || property?.building?.size?.grosssize;
                
                if (avgValue && squareFeet && squareFeet > 0) {
                    pricePerSqft = Math.round(avgValue / squareFeet);
                }
            }
            
            const basicInfo = document.getElementById('basicInfo');
            basicInfo.innerHTML = `
                ${squareFeet ? `
                <div class="info-box">
                    <div class="info-icon">üìè</div>
                    <div class="info-label">Square Feet</div>
                    <div class="info-value">${squareFeet.toLocaleString()}</div>
                </div>
                ` : ''}
                ${pricePerSqft ? `
                <div class="info-box" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); border-color: #10b981;">
                    <div class="info-icon" style="color: #fff;">$/SqFt</div>
                    <div class="info-label" style="color: rgba(255,255,255,0.9);">Price per Sq Ft</div>
                    <div class="info-value" style="color: #fff;">$${pricePerSqft.toLocaleString()}</div>
                </div>
                ` : ''}
                <div class="info-box">
                    <div class="info-icon">üõèÔ∏è</div>
                    <div class="info-label">Bedrooms</div>
                    <div class="info-value">${property?.building?.rooms?.beds || 'N/A'}</div>
                </div>
                <div class="info-box">
                    <div class="info-icon">üöø</div>
                    <div class="info-label">Bathrooms</div>
                    <div class="info-value">${property?.building?.rooms?.bathstotal || 'N/A'}</div>
                </div>
                <div class="info-box">
                    <div class="info-icon">üìÖ</div>
                    <div class="info-label">Year Built</div>
                    <div class="info-value">${property?.summary?.yearbuilt || 'N/A'}</div>
                </div>
            `;
            
            window.scrollTo({ top: document.getElementById('preliminaryResults').offsetTop - 100, behavior: 'smooth' });
        }
        
        function showLeadForm() {
            document.getElementById('preliminaryResults').style.display = 'none';
            document.getElementById('leadFormSection').style.display = 'block';
            document.getElementById('currentStep').textContent = '2';
            document.getElementById('progressFill').style.width = '100%';
            
            window.scrollTo({ top: document.getElementById('leadFormSection').offsetTop - 100, behavior: 'smooth' });
        }
        
        function showFullResults(data) {
            document.getElementById('leadFormSection').style.display = 'none';
            document.getElementById('fullResults').style.display = 'block';
            
            if (window.displayResults) {
                // Prepare formData from the form fields
                const formData = {
                    address: document.getElementById('address').value,
                    city: document.getElementById('city').value,
                    state: document.getElementById('state').value,
                    zipcode: document.getElementById('zipcode').value,
                    squareFeet: document.getElementById('squareFeet').value
                };
                window.displayResults(data, formData);
            }
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        document.getElementById('leadForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const submitBtn = e.target.querySelector('.submit-btn');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Sending...';
            submitBtn.disabled = true;
            
            // Prepare property details from stored data
            const propertyDetails = {};
            if (propertyData) {
                // Get ATTOM Property ID
                if (propertyData.property?.identifier?.Id) {
                    propertyDetails.attomId = propertyData.property.identifier.Id;
                } else if (propertyData.property?.identifier?.attomId) {
                    propertyDetails.attomId = propertyData.property.identifier.attomId;
                }
                
                // Get value range from display
                const valueRangeText = document.getElementById('valueRange')?.textContent;
                if (valueRangeText) {
                    propertyDetails.estimatedValue = valueRangeText;
                }
                
                // Get property info from data
                if (propertyData.property) {
                    const property = propertyData.property;
                    
                    propertyDetails.squareFeet = property?.building?.size?.bldgsize 
                        || property?.building?.size?.universalsize 
                        || property?.building?.size?.livingsize
                        || property?.building?.size?.grosssize
                        || document.getElementById('squareFeet').value;
                    
                    propertyDetails.bedrooms = property?.building?.rooms?.beds;
                    propertyDetails.bathrooms = property?.building?.rooms?.bathstotal;
                    propertyDetails.yearBuilt = property?.summary?.yearbuilt;
                    propertyDetails.propertyType = property?.summary?.proptype;
                }
            }
            
            const leadData = {
                type: 'residential',
                name: document.getElementById('leadName').value,
                email: document.getElementById('leadEmail').value,
                phone: document.getElementById('leadPhone').value,
                propertyAddress: `${document.getElementById('address').value}, ${document.getElementById('city').value}, ${document.getElementById('state').value} ${document.getElementById('zipcode').value}`,
                propertyDetails: propertyDetails,
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent
            };
            
            console.log('üéØ LEAD CAPTURED:', leadData);
            
            try {
                const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwtE1bn0GFZBEWbOzqs1EyqLheS8olbFUzCogc4EdiL6BIgbPVSSkJfGrJDA3TOF4Ui/exec';
                
                console.log('üì§ Sending to:', APPS_SCRIPT_URL);
                
                // –í–ê–ñ–õ–ò–í–û: mode: 'no-cors' –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π –¥–ª—è Google Apps Script!
                fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(leadData)
                });
                
                console.log('‚úÖ Lead sent successfully');
                
                // Track conversion in Google Ads
                if (typeof gtag_report_conversion === 'function') {
                    gtag_report_conversion();
                }
                
                document.getElementById('leadFormSection').style.display = 'none';
                
                const successMessage = document.createElement('div');
                successMessage.style.cssText = `
                    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
                    color: white;
                    padding: 50px;
                    border-radius: 20px;
                    text-align: center;
                    margin: 40px 0;
                    box-shadow: 0 20px 60px rgba(16, 185, 129, 0.4);
                    border: 3px solid #fbbf24;
                `;
                successMessage.innerHTML = `
                    <div style="font-size: 4em; margin-bottom: 20px;">‚úÖ</div>
                    <h2 style="font-size: 2.5em; margin-bottom: 20px; color: white;">Thank You!</h2>
                    <p style="font-size: 1.3em; margin-bottom: 15px;">Your information has been received.</p>
                    <p style="font-size: 1.2em; font-weight: 600;">We'll contact you within 24 hours with your cash offer!</p>
                `;
                
                const container = document.querySelector('.container');
                const fullResults = document.getElementById('fullResults');
                container.insertBefore(successMessage, fullResults);
                
                // Hide full results section - user doesn't need to see it
                fullResults.style.display = 'none';
                
                successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                leadSubmitted = true;
                
            } catch (error) {
                console.error('‚ùå Error sending lead:', error);
                
                // Still show success message even if there's an error
                document.getElementById('leadFormSection').style.display = 'none';
                
                const successMessage = document.createElement('div');
                successMessage.style.cssText = `
                    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
                    color: white;
                    padding: 50px;
                    border-radius: 20px;
                    text-align: center;
                    margin: 40px 0;
                    box-shadow: 0 20px 60px rgba(16, 185, 129, 0.4);
                    border: 3px solid #fbbf24;
                `;
                successMessage.innerHTML = `
                    <div style="font-size: 4em; margin-bottom: 20px;">‚úÖ</div>
                    <h2 style="font-size: 2.5em; margin-bottom: 20px; color: white;">Thank You!</h2>
                    <p style="font-size: 1.3em; margin-bottom: 15px;">Your information has been received.</p>
                    <p style="font-size: 1.2em; font-weight: 600;">We'll contact you within 24 hours with your cash offer!</p>
                `;
                
                const container = document.querySelector('.container');
                const fullResults = document.getElementById('fullResults');
                container.insertBefore(successMessage, fullResults);
                fullResults.style.display = 'none';
                
                successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                leadSubmitted = true;
            }
        });
    </script>
</body>
</html>
